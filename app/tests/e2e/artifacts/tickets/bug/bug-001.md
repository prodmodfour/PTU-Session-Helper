---
ticket_id: bug-001
ticket_type: bug
priority: P2
status: in-progress
source: code-review-034
domain: csv-import
affected_files:
  - app/server/services/csv-import.service.ts
created_at: 2026-02-18T21:00:00
---

## Summary

In `parsePokemonSheet`, both `swim` and `sky` capabilities read from the same CSV cell (`row 33, col 13`). Sky should read from a different cell.

## Evidence

`csv-import.service.ts:251-253`:
```typescript
swim: parseNumber(getCell(rows, 33, 13)) || 0,
sky: parseNumber(getCell(rows, 33, 13)) || 0,   // <-- same cell as swim
```

## Impact

Every Pokemon imported via CSV gets the same value for swim and sky. If a Flying Pokemon has sky 6 and swim 0, the CSV import would set both to whatever is in cell (33, 13).

## Fix

Determine the correct cell reference for sky capability in the PTU character sheet CSV format and update line 253. The original code in `import-csv.post.ts` had the same bug — this is a pre-existing issue faithfully reproduced during refactoring-028.

## Fix Log

- **Commit 1 (WRONG):** 3d7413b — all row indices off by +1 (used 32/33/34 instead of 31/32/33). Caught by rules-review-034.
- **Commit 2:** (pending) — corrected all row indices to 31/32/33. sky now reads (32,13), swim reads (33,13) — separate cells. See bug-002 fix log for full details.
