# Code Review 104 â€” ptu-rule-050: Remove dead pokeBallType parameter

**Ticket:** ptu-rule-050
**Commit:** `aa4d51a`
**Author:** prodmodfour
**Reviewer:** Senior Reviewer
**Date:** 2026-02-20

---

## Verdict: APPROVED

---

## Summary

The commit removes the unused `pokeBallType?: string` field from two locations:

1. `app/server/api/capture/attempt.post.ts` -- removed from `CaptureAttemptRequest` interface
2. `app/composables/useCapture.ts` -- removed from `attemptCapture` params and from the API call body

The `modifiers` comment was updated to clarify it covers ball modifiers (pre-calculated by GM).

## Checklist

### 1. Was `pokeBallType` truly dead code?

**Yes.** Verified by:

- The field was declared in the `CaptureAttemptRequest` interface but never read by any server logic. The handler (`attempt.post.ts`) destructures only `pokemonId`, `trainerId`, `accuracyRoll`, and `modifiers` from `body`. `pokeBallType` was never accessed.
- No component, composable, or test file was passing `pokeBallType` to the API. The E2E helper (`capture-helpers.ts`) uses `Record<string, any>` and no test passes a `pokeBallType` key.
- `grep` for `pokeBallType` across all `.vue` and `.ts` files returns zero matches after this commit.

### 2. Is the removal clean?

**Yes.** No dangling references remain in source code:

- `app/server/api/capture/attempt.post.ts` -- interface is clean, no trailing comma issues
- `app/composables/useCapture.ts` -- param list is clean, API call body is clean
- No other source file ever imported or referenced the field

### 3. Is the updated comment accurate?

**Yes.** The new comment reads:

```typescript
modifiers?: number     // Equipment/feature/ball modifiers (pre-calculated by GM)
```

This accurately describes how the system works: the GM pre-calculates the numeric modifier (including ball-type adjustments) and passes it as the `modifiers` value. The old comment said "Equipment/feature modifiers" which was incomplete -- the new wording correctly includes "ball" in the scope.

### 4. Remaining `pokeBallType` references

References remain only in **documentation/artifact markdown files** (not in source code):

- `artifacts/loops/capture.md` -- historical loop output (read-only reference data)
- `artifacts/matrix/capture-audit.md` -- audit describing the gap (now resolved)
- `artifacts/matrix/capture-matrix.md` -- matrix analysis (historical)
- `artifacts/matrix/capture-capabilities.md` -- capability catalog (now stale for this field)
- `artifacts/matrix/pokemon-lifecycle-capabilities.md` -- lifecycle catalog (now stale for this field)
- `artifacts/reviews/rules-review-079.md` -- historical review
- `artifacts/reviews/rules-review-047.md` -- historical review
- `artifacts/tickets/ptu-rule/ptu-rule-050.md` -- the ticket itself (expected)

These are all artifact/documentation files that describe historical state. They do not affect runtime behavior. The capability catalog files (`capture-capabilities.md`, `pokemon-lifecycle-capabilities.md`) now have a stale interface signature, but capability catalogs are regenerated by the matrix pipeline -- they are not consumed by the application.

**No action required** for these references.

### 5. Commit quality

- Commit message is clear and well-structured, explaining what was removed and why
- References the ticket ID
- Scope is minimal and focused -- exactly two source files changed, plus the ticket and dev-state metadata
- Dev-state updated to `in-progress` (should be moved to `resolved` once this review is approved)

### 6. No regressions

- No tests referenced `pokeBallType` in their assertions or payloads
- The `attemptCapture` E2E helper uses `Record<string, any>`, so even if a test had passed the field, the server would have silently ignored it (since it was never read)
- The `modifiers` pathway is completely untouched

## Issues

None.
